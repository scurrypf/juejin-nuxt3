<script setup>
import { Viewer } from '@bytemd/vue-next'
import breaks from '@bytemd/plugin-breaks'
import gemoji from '@bytemd/plugin-gemoji'
import gfm from '@bytemd/plugin-gfm'
import highlight from '@bytemd/plugin-highlight'
import math from '@bytemd/plugin-math-ssr'
import medium from '@bytemd/plugin-medium-zoom'
import mermaid from '@bytemd/plugin-mermaid'
import frontmatter from '@bytemd/plugin-frontmatter'
import themeStyle from '../../utils/theme'
import highlightStyle from '../../utils/highLight'
import { getProcessor } from 'bytemd'
import { visit } from 'unist-util-visit'
import { onMounted, onUnmounted, ref, nextTick } from 'vue'

// 渲染文章
const plugins = [breaks(), frontmatter(), highlightStyle(), themeStyle(), gemoji(), gfm(), highlight(), math(), medium({ background: 'rgba(0, 0, 0, 0.7)' }), mermaid()]

const route = useRoute()
const url = ref(`/api/article/${route.params.id}`)
const article = await useFetch(url);
const ad = await useFetch('/api/ad?adid=3');

const adSrc = `http://localhost:1337${ad.data.value.adimg.url}`
const display = article.data.value.content;
const src = `http://localhost:1337${article.data.value.img.url}`
const good = article.data.value.good;
const see = article.data.value.see;
const authorName = article.data.value.author.name;
const authid = article.data.value.author.id;
const level = `http://localhost:1337${article.data.value.author.level.url}`;
const badage = `http://localhost:1337${article.data.value.author.badge.url}`;
const headImg = `http://localhost:1337${article.data.value.author.headImg.url}`;
const authorDiscuss = article.data.value.author.discuss;

const abouturl = ref(`/api/aboutArt?authid=${authid}`);
const about = await useFetch(abouturl);
const aboutArr = about.data.value;

// 生成目录
let catalogueList = ref([]);
// 将标题节点编译成文本
const stringifyHeading = function (e) {
    let result = '';
    visit(e, (node) => {
        if (node.type === 'text') {
            result += node.value;
        }
    })
    return result;
}
// 生成目录
getProcessor({
    plugins: [{   // 通过getProcessor得到的文章的节点
        rehype: (p) => p.use(() => (tree) => {
            if (tree && tree.children.length) {
                let items = [];
                // 过滤出html的DOM节点
                let elementTree = tree.children.filter((v) => {
                    return v.type === 'element'
                })
                // 通过forEach遍历
                elementTree.forEach((node) => {
                    const removeTheme = node.children.filter((item) => item.value?.includes('theme'))
                    const removeHl = node.children.filter((item) => item.value?.includes('highlight'))
                    if (node.tagName[0] === 'h' && node.children.length && removeTheme.length === 0 && removeHl.length === 0) {
                        const i = Number(node.tagName[1])
                        items.push({
                            level: i,
                            text: stringifyHeading(node),
                        })
                    }
                })
                // 筛选出h1、h2、h3标题，然后赋给catalogueList渲染
                catalogueList.value = items.filter((v) => {
                    return v.level === 1 || v.level === 2 || v.level === 3 || v.level === 4;
                });
            }
        }),
    },
    ],
}).processSync(display);
let creatCatogry = catalogueList.value;
// 标题样式改变
const cateClass = (type) => {
    if (type === 2) return 'dir-content1';
    if (type === 3) return 'dir-content2';
    if (type === 4) return 'dir-content3';
    return 'dir-content1';
}

let isActive = shallowRef();
let heading = ref([]);
let headerHeight = shallowRef(0);
let itemOffsetTop = ref([]);
let liRef = ref([]);
const navRef = ref()
const navMid = shallowRef(0)
const currentScrollTop = shallowRef(0)
// 赋值属性唯一ID
const transformToId = () => {
    const articleDom = document.getElementById('markdown-body');
    const children = Array.from(articleDom.children);
    if (children.length > 0) {
        let index = 0;
        for (let i = 0; i < children.length; i++) {
            const tagName = children[i].tagName;
            if (tagName === 'H1' || tagName === 'H2' || tagName === 'H3') {
                children[i].setAttribute('data-id', `heading-${index}`);
                index++;
            }
        }
    }
}
// 实现点击跳转
const activeSelect = (index) => {
    if (isActive.value === index) return;
    heading.value[index].scrollIntoView();
    window.scrollBy(0, -headerHeight.value - 30);
    isActive.value = index;
}
// 获得h1,h2,h3,h4初始位置的标签
const getInitByScroll = () => {
    const articleDom = document.getElementById('markdown-body');
    const headings = articleDom?.querySelectorAll('h1, h2, h3, h4');
    headings?.forEach((item) => {
        heading.value.push(item);
    })
    itemOffsetTop.value = [];
    creatCatogry.forEach((val, i) => {
        const firstHead = heading.value[i];
        if (firstHead) {
            itemOffsetTop.value?.push({
                key: i,
                top: firstHead.offsetTop,
            })
        }
    })

}
// 实现滚动事件监听
const onScroll = () => {
    currentScrollTop.value = document.documentElement.scrollTop || window.pageYOffset || document.body.scrollTop
    const scrollTop = currentScrollTop.value - headerHeight.value + 20;
    const itemOffsetTopLength = itemOffsetTop.value.length
    for (let n = 0; n < itemOffsetTopLength; n++) {
        if (scrollTop >= itemOffsetTop.value[n].top - headerHeight.value)
            isActive.value = itemOffsetTop.value[n].key
    }
    if (isActive.value) {
        const activeEleTop = liRef.value[isActive.value].offsetTop;
        navMid.value > activeEleTop ? navRef.value.scrollTo({
            top: 0,
        }) : navRef.value.scrollTo({
            top: activeEleTop - navMid.value,
        })
    }
}
const isRender = useState('isRender', () => false)
useHead({
    title: article.data.value.tittle
})
onMounted(() => {
    window.addEventListener('scroll', onScroll);
    transformToId();
    isRender.value = true;
    nextTick(() => {
        getInitByScroll();
    })
});
onUnmounted(() => {
    window.removeEventListener('scroll', onScroll)
});
</script>

<template>
    <div class="main">
        <AsideBtn></AsideBtn>
        <div class="body" v-show="isRender">
            <div class="content">
                <h1>{{ article.data.value.tittle }}</h1>
                <div class="content-author">
                    <div class="author-Img">
                        <img class="headImg" :src="headImg" />
                    </div>
                    <div class="author-in">
                        <div class="name">{{ authorName }}
                            <span>
                                <img width="35" height="16" :src="level" />
                                <img width="16" height="16" :src="badage" />
                            </span>
                        </div>
                        <div class="ident">{{ article.data.value.createdAt }}&nbsp; · &nbsp;阅读{{ see }}</div>
                    </div>
                </div>
                <div>
                    <img :src="src" width="755" height="425" />
                </div>
                <div class="content-body">
                    <Viewer id="markdown-body" class="markdown-body" :value="display" :plugins="plugins" />
                </div>
                <div class="body-bottom">
                    <div class="bottom-tab">
                        <div class="read">
                            <div class="read-main">
                                分类:
                            </div>
                            <el-button>阅读</el-button>
                        </div>
                        <div class="lab">
                            <div class="lab-main">
                                标签:
                            </div>
                            <el-button type="primary" plain>青训营</el-button>
                        </div>
                    </div>
                </div>
            </div>
            <div>
                <div class="author">
                    <div class="info">
                        <div class="infoImg">
                            <img class="headImg" :src="headImg" />
                        </div>
                        <div class="info-in">
                            <div class="name">{{ authorName }}
                                <span>
                                    <img width="35" height="16" :src="level" />
                                    <img width="16" height="16" :src="badage" />
                                </span>
                            </div>
                            <div class="ident">{{ authorDiscuss }}</div>
                        </div>
                    </div>
                    <div class="info-btn">
                        <el-button type="primary">关注</el-button>
                        <el-button type="primary" plain>私信</el-button>
                    </div>
                    <div class="info-good">
                        <svg t="1677230370684" class="icon" viewBox="0 0 1024 1024" version="1.1"
                            xmlns="http://www.w3.org/2000/svg" p-id="6461" width="25" height="25">
                            <path
                                d="M216.618667 341.376l2.176 0.085333 2.218666 0.128 2.133334 0.170667 2.133333 0.256 2.133333 0.298667 2.090667 0.384 2.090667 0.384 2.048 0.426666 2.048 0.512 2.090666 0.554667 2.005334 0.597333 1.962666 0.64 1.962667 0.682667 1.962667 0.725333 1.92 0.810667 1.877333 0.853333 1.877333 0.853334 1.877334 0.896 1.834666 0.938666 1.792 1.066667 1.749334 1.024 1.792 1.109333 1.706666 1.109334 1.664 1.194666 1.706667 1.152 1.578667 1.28 1.621333 1.28 1.536 1.28 1.536 1.408 1.493333 1.365334 1.450667 1.450666 1.450667 1.450667 1.408 1.450667 1.365333 1.578666 1.28 1.536 1.28 1.621334 1.28 1.621333 1.237333 1.621333 1.152 1.706667 1.109334 1.706667 1.109333 1.706666 1.024 1.792 1.024 1.792 0.938667 1.834667 0.981333 1.834667 0.853333 1.877333 0.853334 1.92 0.768 1.92 0.725333 1.962667 0.682667 1.962666 0.682666 1.962667 0.597334 2.048 0.554666 2.005333 0.469334 2.048 0.469333 2.090667 0.426667 2.090667 0.298666 2.090666 0.298667 2.133334 0.298667 2.133333 0.213333 2.133333 0.128 2.176 0.085333 2.176v2.218667l0.64 341.333333v2.133334l-0.085333 2.133333-0.128 2.133333-0.170667 2.048-0.213333 2.133334-0.298667 2.048-0.384 2.048-0.384 2.048-0.426666 2.090666-0.426667 2.048-0.554667 2.005334-0.597333 2.005333-0.597333 1.962667-0.682667 2.005333-0.725333 1.962667-0.768 1.877333-0.853334 1.962667-0.853333 1.877333-0.853333 1.877333-1.024 1.877334-0.981334 1.792-1.066666 1.834666-1.066667 1.792-1.152 1.706667-1.152 1.792-1.28 1.706667-1.237333 1.621333-1.28 1.664-1.365334 1.621333-1.408 1.578667-1.408 1.536-1.536 1.536-1.493333 1.450667-1.536 1.493333-1.578667 1.365333-1.621333 1.365334-1.664 1.28-1.664 1.322666-1.706667 1.237334-1.706666 1.194666-1.749334 1.109334-1.792 1.109333-1.792 1.066667-1.834666 0.981333-1.834667 0.938667-1.92 0.938666-1.877333 0.853334-1.92 0.853333-1.92 0.768-1.962667 0.725333-1.962667 0.64-2.005333 0.64-1.962667 0.597334-2.048 0.512-2.048 0.512-2.005333 0.426666-2.048 0.384-2.133333 0.341334-2.048 0.298666-2.133334 0.213334-2.048 0.170666-2.133333 0.170667L217.173333 853.333333h-5.290666l-2.133334-0.085333-2.176-0.170667-2.176-0.213333-2.133333-0.213333-2.133333-0.298667-2.133334-0.341333-2.090666-0.426667-2.048-0.426667-2.048-0.512-2.005334-0.554666-2.048-0.554667-2.005333-0.682667-1.962667-0.682666-1.92-0.768-1.962666-0.768-1.877334-0.853334-1.877333-0.853333-1.834667-0.896-1.834666-0.981333-1.834667-0.981334-1.706667-1.066666-1.749333-1.066667-1.706667-1.152-1.706666-1.152-1.664-1.237333-1.621334-1.194667-1.621333-1.322667-1.536-1.28-1.578667-1.365333-1.493333-1.408-1.450667-1.408-1.408-1.450667-1.408-1.536-1.365333-1.536-1.28-1.536-1.28-1.578666-1.28-1.621334-1.194667-1.706666-1.194666-1.706667-1.109334-1.706667-1.109333-1.706666-1.066667-1.792-0.981333-1.749334-0.981333-1.834666-0.896-1.877334-0.896-1.834666-0.853334-1.92-0.768-1.92-0.768-1.962667-0.682666-1.92-0.64-2.048-0.597334-2.005333-0.554666-2.005334-0.512-2.090666-0.469334-2.048-0.384-2.133334-0.341333-2.048-0.298667-2.133333-0.256-2.133333-0.213333-2.133334-0.128-2.218666-0.085333-2.133334-0.042667-2.261333-0.597333-341.333333v-2.133334l0.085333-2.048 0.128-2.133333 0.170667-2.090667 0.256-2.090666 0.256-2.133334 0.341333-2.005333 0.384-2.090667 0.426667-2.048 0.469333-2.005333 0.554667-2.048 0.554666-2.005333 0.64-1.962667 0.64-2.005333 0.725334-1.92 0.810666-1.962667 0.810667-1.877333 0.853333-1.92 0.938667-1.877334 0.938667-1.834666 0.981333-1.877334 1.066667-1.792 1.066666-1.749333 1.194667-1.792 1.152-1.706667 1.237333-1.706666 1.28-1.706667 1.28-1.621333 1.365334-1.621334 1.408-1.578666 1.450666-1.536 1.450667-1.493334 1.536-1.536 1.536-1.408 1.621333-1.450666 1.578667-1.322667 1.621333-1.28 1.706667-1.28 1.706667-1.28 1.706666-1.152 1.706667-1.152 1.834667-1.109333 1.792-1.024 1.792-1.024 1.92-0.938667 1.834666-0.938667 1.877334-0.853333 1.92-0.853333 1.962666-0.725334 1.962667-0.768 1.962667-0.682666 1.962666-0.64 2.048-0.554667 2.005334-0.554667 2.005333-0.426666 2.048-0.469334 2.090667-0.426666 2.048-0.298667 2.048-0.298667 2.133333-0.213333 2.090667-0.170667 2.133333-0.128 2.133333-0.085333L213.461333 341.333333h0.938667l2.176 0.042667zM213.76 384h-1.365333l-1.024 0.042667-1.066667 0.042666-1.024 0.128-1.066667 0.128-1.024 0.128-1.024 0.170667-1.024 0.170667-1.066666 0.256-1.024 0.213333-0.981334 0.298667-0.981333 0.256-1.024 0.341333-0.981333 0.341333-0.938667 0.341334-0.981333 0.426666-0.981334 0.384-0.938666 0.426667-0.938667 0.469333-0.938667 0.469334-0.896 0.512-0.896 0.554666-0.896 0.554667-0.853333 0.554667-0.853333 0.554666-0.853334 0.597334-0.853333 0.64-0.853333 0.682666-0.810667 0.682667-0.768 0.682667-0.768 0.725333-0.768 0.768-0.725333 0.725333-0.725334 0.810667-0.725333 0.810667-0.682667 0.768-0.64 0.853333-0.64 0.853333-0.597333 0.810667-0.597333 0.853333-0.554667 0.853334-0.554667 0.938666-0.512 0.896-0.512 0.938667-0.469333 0.853333-0.469333 0.981334-0.426667 0.938666-0.426667 0.981334-0.341333 0.938666-0.426667 0.981334-0.341333 0.981333-0.298667 1.024-0.298666 0.981333-0.256 1.024-0.213334 1.024-0.213333 0.981334-0.213333 1.024-0.170667 1.066666-0.128 1.066667-0.128 1.024-0.085333 1.066667v1.024l-0.085334 1.066666v1.322667l0.597334 340.821333v1.365334l0.042666 1.109333 0.085334 1.066667 0.085333 1.109333 0.128 1.066667 0.170667 1.066666 0.170666 1.066667 0.213334 1.024 0.213333 1.024 0.256 1.024 0.256 1.024 0.298667 0.981333 0.384 1.024 0.341333 0.938667 0.341333 0.981333 0.384 0.938667 0.426667 0.981333 0.426667 0.853334 0.426666 0.981333 0.512 0.853333 0.512 0.938667 0.512 0.853333 0.554667 0.853334 0.554667 0.896 0.597333 0.853333 0.597333 0.853333 0.597334 0.810667 0.64 0.768 0.725333 0.810667 0.682667 0.725333 0.682666 0.768 0.725334 0.768 0.725333 0.682667 0.768 0.725333 0.768 0.682667 0.768 0.682666 0.853333 0.64 0.768 0.597334 0.853334 0.597333 0.853333 0.597333 0.853333 0.554667 0.853334 0.554667 0.896 0.512 0.896 0.512 0.896 0.469333 0.896 0.426667 0.938666 0.426666 0.981334 0.469334 0.938666 0.426666 0.981334 0.341334 0.981333 0.341333 0.981333 0.341333 0.981334 0.256 1.024 0.298667 0.981333 0.213333 1.066667 0.256 1.024 0.170667 1.066666 0.170667 1.066667 0.170666 1.066667 0.085334 1.066666 0.128 1.109334 0.042666 1.109333 0.042667 1.408 0.042667h2.773333l1.024-0.128 1.066667-0.085334 1.024-0.085333 1.066667-0.170667 1.024-0.170666 1.024-0.170667 1.024-0.256 1.024-0.256 0.981333-0.213333 1.024-0.341334 1.024-0.298666 0.981333-0.298667 0.981334-0.426667 0.938666-0.341333 0.981334-0.426667 0.938666-0.426666 0.896-0.426667 0.938667-0.512 0.896-0.512 0.938667-0.512 0.853333-0.554667 0.938667-0.597333 0.853333-0.597333 0.810667-0.597334 0.853333-0.64 0.853333-0.64 0.768-0.682666 0.768-0.682667 0.810667-0.768 0.768-0.682667 0.725333-0.810666 0.725334-0.725334 0.682666-0.810666 0.682667-0.853334 0.64-0.768 0.64-0.853333 0.64-0.853333 0.554667-0.853334 0.597333-0.853333 0.512-0.896 0.554667-0.938667 0.512-0.853333 0.426666-0.981333 0.512-0.938667 0.426667-0.938667 0.426667-0.981333 0.384-0.938667 0.341333-0.981333 0.341333-1.024 0.298667-0.981333 0.298667-0.981334 0.256-1.024 0.256-0.981333 0.213333-1.066667 0.170667-1.024 0.170666-1.024 0.128-1.024 0.128-1.066666 0.085334-1.024 0.085333-1.066667v-1.066667l0.042667-1.28-0.64-340.821333v-2.517333l-0.128-1.109334-0.085334-1.066666-0.128-1.066667-0.170666-1.066667-0.170667-1.066666-0.170667-1.024-0.256-1.024-0.213333-1.024-0.298667-1.024-0.298666-0.981334-0.298667-0.981333-0.341333-0.981333-0.426667-0.938667-0.341333-1.024-0.426667-0.896-0.426667-0.938667-0.469333-0.938666-0.512-0.853334-0.512-0.938666-0.512-0.853334-0.512-0.896-0.597333-0.853333-0.554667-0.853333-0.597333-0.853334-0.64-0.810666-0.64-0.810667-0.682667-0.768-0.682667-0.768-0.682666-0.725333-0.725334-0.768-0.768-0.725334-0.725333-0.682666-0.768-0.682667-0.810667-0.64-0.768-0.682667-0.810666-0.597333-0.853334-0.64-0.853333-0.597333-0.853333-0.554667-0.853334-0.554667-0.853333-0.512-0.938667-0.426666-0.938666-0.554667-0.853334-0.426667-0.981333-0.426666-0.938667-0.426667-0.938666-0.384-0.981334-0.384-0.981333-0.298667-0.981333-0.341333-1.024-0.298667-0.981334-0.298666-1.024-0.213334-1.024-0.256-1.024-0.213333-1.066666-0.128-1.066667-0.170667-1.109333-0.128-1.066667-0.085333-1.066667-0.085333h-1.109333L214.144 384h-0.426667zM640.085333 95.317333l2.517334 0.213334 2.474666 0.298666 2.56 0.426667 2.474667 0.554667 2.56 0.64 2.645333 0.853333 2.56 0.853333 2.602667 0.938667 2.56 0.981333 2.474667 1.024 2.432 1.066667 2.432 1.152 2.346666 1.194667 2.304 1.28 2.304 1.28 2.261334 1.408 2.218666 1.408 2.176 1.450666 2.133334 1.536 2.090666 1.578667 2.005334 1.621333 2.005333 1.621334 1.962667 1.706666 1.92 1.749334 1.834666 1.792 1.792 1.834666 1.749334 1.877334 1.792 1.877333 1.621333 2.005333 1.621333 1.962667 1.578667 2.005333 1.536 2.048 1.493333 2.133334 1.408 2.133333 1.365334 2.133333 1.322666 2.176 1.28 2.261334 1.194667 2.261333 1.152 2.261333 1.109333 2.346667 1.066667 2.304 0.981333 2.346667 0.938667 2.432 0.853333 2.389333 0.853334 2.389333 0.768 2.474667 0.725333 2.474667 0.64 2.474666 0.554667 2.56 0.554666 2.517334 0.426667 2.517333 0.426667 2.56 0.341333 2.56 0.298667 2.602667 0.213333 2.56 0.170667 2.645333 0.085333 2.602667v5.248l-0.128 2.645333-0.170667 2.645333-0.213333 2.645334-0.341333 2.645333-0.341334 2.645333-0.469333 2.688-0.469333 2.645334-0.597334 2.645333-0.64 2.688-0.725333 2.645333L693.76 341.333333h135.637333l2.432 0.042667 2.432 0.085333 2.474667 0.170667 2.389333 0.256 2.432 0.298667 2.432 0.426666 2.346667 0.426667 2.346667 0.554667 2.389333 0.554666 2.304 0.64 2.261333 0.725334 2.304 0.768 2.261334 0.810666 2.218666 0.896 2.176 0.938667 2.218667 1.024 2.133333 1.152 2.133334 1.109333 2.048 1.194667 2.048 1.28 2.005333 1.28 1.962667 1.365333 1.92 1.493334 1.962666 1.493333 1.834667 1.536 1.792 1.578667 1.792 1.706666 1.706667 1.664 1.706666 1.706667 1.664 1.877333 1.578667 1.834667 1.536 1.92 1.493333 2.005333 1.408 1.962667 1.365334 2.005333 1.28 2.048 1.28 2.133334 1.152 2.133333 1.109333 2.133333 1.066667 2.218667 0.981333 2.133333 0.853333 2.261334 0.896 2.218666 0.853334 2.304 0.682666 2.304 0.64 2.304 0.597334 2.346667 0.554666 2.304 0.426667 2.346667 0.426667 2.346666 0.341333 2.432 0.298667 2.389334 0.170666 2.389333 0.128 2.432 0.085334 2.389333v2.389334l-0.085334 2.432-0.128 2.432-0.213333 2.389333-0.298667 2.432-0.384 2.432-0.426666 2.389333-0.426667 2.389334-0.64 2.389333-76.842667 307.541333-0.725333 2.688-0.768 2.688-0.810667 2.645334-0.853333 2.602666-0.896 2.645334-0.981333 2.517333-1.024 2.56-1.066667 2.517333-1.152 2.474667-1.152 2.432-1.237333 2.432-1.237334 2.389333-1.322666 2.346667-1.322667 2.304-1.450667 2.304-1.450666 2.261333-1.450667 2.176-1.536 2.218667-1.578667 2.133333-1.621333 2.133334-1.664 2.048-1.706667 2.090666-1.749333 2.005334-1.749333 1.962666-1.877334 1.92-1.834666 1.92-1.877334 1.834667-1.92 1.792-2.005333 1.792-2.005333 1.706667-2.005334 1.706666-2.048 1.664-2.133333 1.621334-2.133333 1.536-2.176 1.578666-2.176 1.450667-2.261334 1.408-2.218666 1.408-2.304 1.322667-2.346667 1.28-2.304 1.28-2.389333 1.194666-2.346667 1.152-2.474667 1.109334-2.432 1.066666-2.474666 0.981334-2.517334 0.981333-2.474666 0.938667-2.56 0.853333-2.56 0.810667-2.56 0.725333-2.602667 0.725333-2.645333 0.64-2.645334 0.597334-2.645333 0.512-2.688 0.469333-2.688 0.426667-2.688 0.426666-2.730667 0.298667-2.730666 0.256-2.730667 0.213333-2.816 0.128-2.730667 0.085334-2.858666 0.042666h-284.586667l-2.133333-0.128-2.133334-0.128-2.090666-0.170666-2.090667-0.213334-2.048-0.298666-2.048-0.341334-2.090667-0.384-2.048-0.426666-2.005333-0.426667-2.005333-0.597333-2.048-0.554667-1.962667-0.64-1.962667-0.682667-1.962666-0.725333-1.962667-0.768-1.877333-0.853333-1.877334-0.853334-1.877333-0.853333-1.877333-1.024-1.834667-0.981333-1.792-1.024-1.749333-1.109334-1.792-1.109333-1.706667-1.237333-1.706667-1.237334-1.706666-1.237333-1.578667-1.322667-1.664-1.322666-1.578667-1.408-1.536-1.450667-1.493333-1.493333-1.493333-1.493334-1.450667-1.536-1.408-1.578666-1.28-1.664-1.365333-1.621334-1.28-1.664-1.194667-1.706666-1.194667-1.706667-1.152-1.792-1.066666-1.706667-1.066667-1.834666-0.981333-1.834667-0.981334-1.877333-0.896-1.834667-0.853333-1.92-0.853333-1.877333-0.768-1.92-0.725334-2.005334-0.682666-1.962666-0.64-1.962667-0.554667-2.048-0.554667-2.005333-0.469333-2.005334-0.426667-2.048-0.426666-2.048-0.298667-2.090666-0.256-2.048-0.256-2.133334-0.170667-2.090666-0.128-2.090667L341.333333 770.133333 341.333333 768.085333V425.728l0.128-2.133333 0.128-2.133334 0.170667-2.133333 0.256-2.133333 0.256-2.133334 0.341333-2.090666 0.384-2.048 0.426667-2.133334 0.512-2.005333 0.554667-2.048 0.597333-2.048 0.597333-2.005333 0.682667-1.962667 0.768-2.005333 0.768-1.962667 0.853333-1.92 0.853334-1.92 0.938666-1.92 0.981334-1.877333 1.024-1.834667 1.024-1.834667 1.109333-1.834666 1.194667-1.706667 1.194666-1.792 1.237334-1.706667 1.28-1.706666 1.322666-1.664 1.365334-1.664 1.450666-1.578667 1.450667-1.578667 1.493333-1.493333 1.536-1.536 1.578667-1.450667 1.578667-1.408 1.664-1.365333 1.664-1.322667 1.706666-1.28 1.706667-1.28 1.706667-1.194666 1.834666-1.152 1.792-1.109334 1.792-1.066666 1.877334-1.024 1.877333-0.981334 1.92-0.938666 1.877333-0.853334 1.92-0.853333 2.005334-0.768 1.962666-0.725333 2.005334-0.682667 2.005333-0.64 2.048-0.597333 2.048-0.512 2.048-0.512 2.090667-0.426667 2.090666-0.426667 2.090667-0.341333 2.133333-0.298667 2.090667-0.213333 2.133333-0.213333 2.133334-0.128 2.133333-0.085334H430.933333l2.986667-0.213333 2.944-0.256 2.986667-0.384 2.901333-0.426667 2.901333-0.597333 2.816-0.64 2.858667-0.768 2.773333-0.853333 2.773334-0.981334 2.730666-1.024 2.645334-1.194666 2.645333-1.194667 2.56-1.322667 2.56-1.408 2.474667-1.493333 2.474666-1.578667 2.346667-1.664 2.346667-1.749333 2.261333-1.792 2.218667-1.877333 2.133333-2.048 2.048-2.005334 2.005333-2.133333 1.962667-2.218667 1.834667-2.261333 1.749333-2.346667 1.706667-2.389333 1.664-2.517333 1.536-2.56 1.450666-2.602667 1.365334-2.688 81.92-166.954667 1.194666-2.304 1.28-2.218666 1.365334-2.133334 1.450666-2.133333 1.536-1.92 1.621334-1.962667 1.664-1.792 1.749333-1.749333 1.834667-1.706667 1.92-1.536 1.962666-1.536 2.005334-1.365333 2.048-1.322667 2.133333-1.28 2.176-1.066666 2.176-1.024 2.304-0.981334 2.261333-0.853333 2.346667-0.725333 2.346667-0.64 2.432-0.554667 2.389333-0.426667 2.432-0.341333 2.474667-0.256 2.474666-0.128h2.474667l2.517333 0.085333z m-3.754666 42.581334l-0.597334 0.042666-0.64 0.042667-0.597333 0.085333-0.597333 0.128-0.597334 0.128-0.597333 0.170667-0.597333 0.170667-0.597334 0.256-0.554666 0.256-0.597334 0.256-0.554666 0.298666-0.554667 0.298667-0.512 0.341333-0.512 0.341334-0.426667 0.384-0.512 0.384-0.469333 0.426666-0.426667 0.426667-0.426666 0.426667-0.426667 0.469333-0.341333 0.512-0.426667 0.512-0.298667 0.554667-0.298666 0.554666-0.554667 1.024-81.877333 166.912-1.877334 3.669334-2.176 3.968-2.346666 3.84-2.432 3.712-2.56 3.626666-2.730667 3.541334-2.773333 3.413333-2.901334 3.328-3.072 3.242667-3.072 3.072-3.242666 2.986666-3.328 2.858667-3.413334 2.730667-3.498666 2.645333-3.541334 2.474667-3.712 2.389333-3.712 2.261333-3.84 2.090667-3.882666 2.005333-3.968 1.834667-4.010667 1.706667-4.138667 1.621333-4.138666 1.408-4.224 1.28-4.266667 1.152-4.266667 1.024-4.352 0.853333-4.437333 0.725334-4.437333 0.554666-4.437334 0.384-4.522666 0.256h-4.266667l-1.365333 0.085334h-1.109334l-1.109333 0.085333-1.066667 0.128-1.066666 0.085333-1.066667 0.170667-1.024 0.170667-1.066667 0.170666-1.066666 0.256-1.066667 0.213334-1.024 0.298666-1.024 0.298667-1.024 0.298667-0.981333 0.341333-1.024 0.426667-0.981334 0.341333-1.024 0.426667-0.981333 0.469333-0.938667 0.426667-0.938666 0.512-0.938667 0.512-0.938667 0.597333-0.896 0.554667-0.896 0.554666-0.938666 0.597334-0.853334 0.64-0.853333 0.64-0.853333 0.682666-0.810667 0.682667-0.853333 0.725333-0.725334 0.725334-0.853333 0.768-0.682667 0.768-0.768 0.853333-0.725333 0.810667-0.682667 0.810666-0.682666 0.853334-0.64 0.853333-0.64 0.853333-0.597334 0.896-0.597333 0.896-0.554667 0.896-0.554666 0.981334-0.512 0.853333-0.469334 1.024-0.469333 0.938667-0.426667 0.981333-0.426666 0.981333-0.426667 0.981334-0.384 0.981333-0.341333 1.066667-0.341334 1.024-0.298666 1.024-0.256 1.024-0.256 1.024-0.213334 1.024-0.213333 1.066666-0.170667 1.066667-0.128 1.109333-0.128 1.066667-0.085333 1.066667-0.085333 1.066666V770.133333l0.085333 1.024 0.085333 1.066667 0.128 1.024 0.128 1.024 0.170667 1.109333 0.170667 1.024 0.213333 0.981334 0.256 1.024 0.256 0.981333 0.298667 1.024 0.298666 0.981333 0.341334 0.981334 0.426666 1.024 0.384 0.938666 0.384 0.938667 0.426667 0.981333 0.426667 0.896 0.512 0.938667 0.512 0.896 0.512 0.896 0.554666 0.896 0.554667 0.853333 0.597333 0.853334 0.597334 0.853333 0.64 0.853333 0.64 0.853334 0.682666 0.853333 0.682667 0.725333 0.768 0.768 0.725333 0.768 0.768 0.768 0.768 0.725334 0.810667 0.682666 0.768 0.682667 0.853333 0.64 0.853334 0.64 0.853333 0.597333 0.853333 0.597334 0.853334 0.554666 0.853333 0.554667 0.938667 0.512 0.896 0.512 0.938666 0.469333 0.938667 0.512 0.938667 0.426667 0.938666 0.384 0.981334 0.384 0.981333 0.384 0.981333 0.341333 0.981334 0.298667 1.024 0.298667 0.981333 0.256 1.024 0.256 1.024 0.213333 1.066667 0.170667 1.024 0.170666 1.024 0.128 1.024 0.128 1.066666 0.085334 1.024 0.085333 1.066667 0.042667H711.082667l1.877333-0.085334 1.834667-0.085333 1.877333-0.128 1.834667-0.170667 1.834666-0.213333 1.792-0.256 1.834667-0.298667 1.792-0.341333 1.792-0.341333 1.749333-0.426667 1.749334-0.426667 1.749333-0.426666 1.706667-0.512 1.706666-0.597334 1.749334-0.554666 1.706666-0.597334 1.664-0.64 1.664-0.682666 1.621334-0.725334 1.621333-0.725333 1.578667-0.768 1.664-0.853333 1.536-0.768 1.578666-0.896 1.493334-0.938667 1.536-0.938667 1.536-0.938666 1.450666-0.981334 1.450667-1.024 1.450667-1.066666 1.408-1.066667 1.365333-1.109333 1.408-1.152 1.28-1.152 1.365333-1.194667 1.28-1.28 1.28-1.194667 1.28-1.28 1.237334-1.28 1.194666-1.28 1.152-1.408 1.152-1.365333 1.109334-1.365333 1.066666-1.450667 1.109334-1.450667 1.024-1.450666 0.981333-1.493334 0.938667-1.493333 0.938666-1.536 0.938667-1.621333 0.853333-1.536 0.853334-1.621334 0.853333-1.578666 0.768-1.706667 0.768-1.621333 0.682667-1.706667 0.682666-1.664 0.682667-1.706667 0.597333-1.749333 0.597334-1.792 0.512-1.792 0.512-1.792 0.554666-2.005333 76.757334-307.029334 0.341333-1.536 0.256-1.194666 0.213333-1.194667 0.170667-1.194667 0.128-1.194666 0.128-1.194667 0.042667-1.237333 0.042666-1.194667V424.96l-0.085333-1.194667-0.085333-1.194666-0.170667-1.194667-0.128-1.194667-0.213333-1.194666-0.213334-1.152-0.298666-1.194667-0.298667-1.152-0.298667-1.152-0.426666-1.152-0.341334-1.152-0.426666-1.109333-0.469334-1.109334-0.469333-1.109333-0.512-1.066667-0.554667-1.066666-0.64-1.109334-0.597333-1.024-0.682667-1.024-0.64-1.024-0.725333-0.981333-0.725333-0.981333-0.768-0.938667-0.853334-0.938667-0.768-0.938666-0.853333-0.853334-0.853333-0.853333-0.938667-0.853333-0.853333-0.810667-0.938667-0.768-0.938667-0.725333-0.981333-0.725334-0.981333-0.682666-1.024-0.64-0.981334-0.682667-1.109333-0.597333-1.024-0.554667-1.066667-0.554667-1.109333-0.512-1.066667-0.426666-1.109333-0.426667-1.109333-0.469333-1.194667-0.384-1.152-0.341334-1.152-0.341333-1.152-0.298667-1.194667-0.256-1.152-0.213333-1.194666-0.170667-1.237334-0.170666-1.237333-0.128-1.194667-0.085334-1.28-0.042666L829.141333 384H693.76l-3.584-0.128-3.541333-0.469333-3.541334-0.725334-3.413333-1.066666-3.328-1.28-3.2-1.621334-3.029333-1.877333-2.944-2.133333-2.688-2.346667-2.517334-2.56-2.304-2.730667-2.005333-2.986666-1.792-3.072-1.493333-3.285334-1.28-3.413333-0.938667-3.413333-0.64-3.498667-0.341333-3.541333-0.085334-3.626667 0.256-3.541333 0.554667-3.584 0.853333-3.456 31.829334-111.616 0.512-1.92 0.426666-1.578667 0.341334-1.621333 0.298666-1.578667 0.298667-1.578667 0.213333-1.664 0.170667-1.578666 0.128-1.578667 0.128-1.578667V201.813333l0.085333-1.621333-0.042666-1.578667-0.042667-1.536-0.085333-1.536-0.128-1.536-0.170667-1.578666-0.213333-1.536-0.256-1.536-0.256-1.536-0.384-1.493334-0.341334-1.536-0.384-1.493333-0.426666-1.450667-0.426667-1.493333-0.512-1.450667-0.512-1.493333-0.597333-1.408-0.597334-1.408-0.597333-1.408-0.682667-1.365333-0.682666-1.408-0.725334-1.365334-0.768-1.28-0.810666-1.365333-0.853334-1.322667-0.853333-1.28-0.853333-1.28-0.938667-1.237333-0.938667-1.194667-0.981333-1.194666-0.981333-1.152-1.024-1.152-1.109334-1.109334-1.066666-1.152-1.109334-1.066666-1.152-1.024-1.152-1.024-1.194666-0.981334-1.237334-0.981333-1.237333-0.938667-1.28-0.896-1.28-0.853333-1.322667-0.853333-1.322666-0.853334-1.408-0.768-1.408-0.768-1.408-0.725333-1.450667-0.682667-1.450667-0.64-1.493333-0.597333-1.536-0.597333-1.536-0.554667-1.578667-0.512-1.450666-0.512-0.853334-0.213333-0.64-0.128-0.64-0.128-0.64-0.085334h-1.877333z"
                                fill="#1296db" p-id="6462"></path>
                        </svg>
                        <span>获得点赞</span>
                        <span>{{ good }}</span>
                    </div>
                    <div class="info-see">
                        <svg t="1677231202476" class="icon" viewBox="0 0 1033 1024" version="1.1"
                            xmlns="http://www.w3.org/2000/svg" p-id="7744" width="25" height="25">
                            <path
                                d="M516.644571 146.285714c150.893714 0 278.930286 67.401143 384 178.578286a775.497143 775.497143 0 0 1 116.297143 160.621714c4.022857 7.460571 6.765714 12.946286 8.265143 16.128l8.045714 17.225143-9.472 16.493714c-1.718857 2.998857-4.900571 8.265143-9.435428 15.36a907.154286 907.154286 0 0 1-125.915429 154.550858C778.825143 812.617143 654.226286 877.714286 516.644571 877.714286c-137.581714 0-262.180571-65.097143-371.785142-172.470857A907.154286 907.154286 0 0 1 18.944 550.765714a418.852571 418.852571 0 0 1-9.435429-15.36l-9.508571-16.530285 8.082286-17.188572c5.485714-11.739429 15.981714-31.341714 31.561143-56.173714A775.497143 775.497143 0 0 1 132.644571 324.864C237.714286 213.686857 365.750857 146.285714 516.644571 146.285714z m415.049143 338.029715a703.012571 703.012571 0 0 0-84.224-109.202286C755.090286 277.394286 645.010286 219.428571 516.644571 219.428571c-128.365714 0-238.445714 57.965714-330.825142 155.684572a703.012571 703.012571 0 0 0-102.546286 140.361143 834.706286 834.706286 0 0 0 112.786286 137.508571C293.193143 748.214857 401.152 804.571429 516.644571 804.571429c115.492571 0 223.451429-56.393143 320.585143-151.552a834.706286 834.706286 0 0 0 112.786286-137.545143c-5.229714-9.508571-11.337143-20.004571-18.322286-31.158857zM516.644571 329.142857c100.242286 0 182.857143 82.614857 182.857143 182.857143 0 101.083429-80.713143 182.857143-182.857143 182.857143-101.083429 0-182.857143-80.713143-182.857142-182.857143 0-101.083429 80.713143-182.857143 182.857142-182.857143z m0 73.142857c-61.549714 0-109.714286 48.786286-109.714285 109.714286 0 61.549714 48.786286 109.714286 109.714285 109.714286 61.549714 0 109.714286-48.786286 109.714286-109.714286 0-59.830857-49.883429-109.714286-109.714286-109.714286z"
                                fill="#1296db" p-id="7745"></path>
                        </svg>
                        <span>文章被阅读</span>
                        <span>{{ see }}</span>
                    </div>
                </div>
                <div class="ads">
                    <img :src="adSrc" width="300" height="90" />
                </div>
                <div class="other">
                    <div class="tittle">相关文章</div>
                    <div class="relation" v-for="(item, index) in aboutArr" :key="index">
                        <div class="rel-tittle">
                            <router-link :to="`/article/${item.id}`" class="rel-tittle" target="_blank">
                                {{ item.tittle }}</router-link>
                        </div>
                        <div class="rel-data">
                            <router-link :to="`/article/${item.id}`" class="rel-data" target="_blank">
                                {{ item.good }}点赞&nbsp; · &nbsp;{{ item.discuss }}评论</router-link>
                        </div>
                    </div>
                </div>
                <div class="dir">
                    <div class="dir-tittle">目录</div>
                    <el-divider />
                    <div ref="navRef">
                        <div v-for="(item,index) in creatCatogry" ref="liRef" :key="index"
                            :class="[{ active: index === isActive }, cateClass(item.level)]" @click="activeSelect(index)">
                        <NuxtLink>{{item.text}}</NuxtLink>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div></template>
<style lang="scss" scoped>
@import "../../assets/scss/article.scss";
</style>